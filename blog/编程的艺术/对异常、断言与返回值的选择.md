---
title: 对异常、断言与返回值的选择
date: 2018-06-20 00:58:55
categories: 编码
tags: 编程思想
---

    编码过程中，难免遇到对异常、断言及返回值选择问题的困惑。本文将收集到网络上对这种选择的总结。因基本没有一个课本对这几个选择有明确的界定，故本文提供建议，仅供参考。

### 返回值
当你实现某个功能可能失败，则可以利用返回值的形式告知调用者失败原因或直接返回失败。

eg: 你找一个目录下不确定存在的东西，没找到即返回没找到。

### 断言
断言即断定绝对不会发生的事情，即不可能事件。
使用场景：在你当前代码逻辑下，你认为100%不会出现某种情况，请使用断言，主要用于开发人员对问题快速定位。

注意：切记勿用断言替代入参检查替代返回值，将导致Release模式下入参的不确定性，而引发未知错误。

eg: 数组索引是否超出范围

### 异常
异常则是你实现的功能99.999%不会失败，但可能0.001%的原因导致失败了，请毫不犹豫使用异常。

eg: 你找一个程序必须的应该存在的配置文件，没找到可以抛出异常。

#### 优点
方便对底层代码的不可能发生的错误进行遏止，留下发生异常原因，然后自杀进程。避免异常蔓延导致难以定位的错误。
异常是处理构造函数失败的唯一途径
#### 缺点
底层代码异常泛滥，顶层代码将要对所有调用进行异常捕获与处理。甚至导致中间过程未处理而出现不可预料的错误。
异常会彻底扰乱程序的执行流程并难以判断，函数也许会在您意料不到的地方返回。
切勿在析构函数中抛出异常，将导致内存泄漏及其他不可预料的错误。
### 其他说法
#### 观点一
也有部分人认为，针对对外接口（客户对象非程序员）不使用异常，因客户可不想看到程序崩溃的情况。而内部接口使用异常，便于开发过程中快速定位错误。

#### 观点二
在google的编码规范中是严禁使用异常的，估计缘由与google现有的大多数C++代码都没有异常处理, 所以引入带有异常处理的新代码相当困难。


---
<small><font color= "gray">本文[Quenwaz](http://quenwaz.github.io)版权所有，转载请说明出处</font></small>